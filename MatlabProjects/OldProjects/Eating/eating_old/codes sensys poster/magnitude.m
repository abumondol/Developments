function mag = magnitude(d)
    mag = sqrt(sum(d.*d, 2));
end